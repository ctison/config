#!/bin/bash
umask 0077
set -euo pipefail
shopt -s nullglob

MODE="${1:-'0600'}"

FILES=$(find .)
for f in $FILES ; do
  test -d "$f" && chmod 0700 "$f"
  test -f "$f" && chmod "$MODE" "$f"
done