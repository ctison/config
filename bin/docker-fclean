#!/bin/sh

set -e

CONTAINERS=$(docker ps -qf status=created -f status=paused -f status=exited -f status=dead)
# shellcheck disable=SC2086
if [ "$CONTAINERS" ]; then
	docker rm -- $CONTAINERS
fi

IMAGES=$(docker images -qf dangling=true)
# shellcheck disable=SC2086
if [ "$IMAGES" ]; then
    docker rmi  -- $IMAGES
fi

exec docker volume prune -f