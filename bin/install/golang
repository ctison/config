#!/bin/bash
umask 0077
VERSION=$(curl -s https://api.github.com/repos/golang/go/git/matching-refs/tags/go | jq -r '.[].ref' | sed 's|^refs/tags/go||' | grep -P '(\d+\.){2}\d+$' | tail -n1)
set -eux

curl -LO https://dl.google.com/go/go"$VERSION".linux-amd64.tar.gz
tar --no-same-{o,p} -C /usr/local -xzf go"$VERSION".linux-amd64.tar.gz
rm go"$VERSION".linux-amd64.tar.gz
ln -st /usr/local/bin /usr/local/go/bin/*

go get -u -v golang.org/x/tools/cmd/goimports