name: x
usage: 42

options:
  oldpwd:
    environment: PWD # Capture $PWD before it gets eventually overwritten by -f config file's directory !

tasks:
  build-kali:
    options:
      options:
        usage: options to pass to docker build command
    run:
      - docker build -f ../docker/kali/Dockerfile -t ctison/kali ${options} ../../

  create-bin:
    args:
      NAME: {}
    run:
      - cp create-bin-template.sh ../../bin/${NAME}
      - chmod 700 ../../bin/${NAME}
      - type code >/dev/null 2>&1 && code ../../bin/${NAME}

  create-bin-install:
    args:
      NAME: {}
    run:
      - cp create-bin-install-template.sh ../../bin/install/${NAME}
      - chmod 700 ../../bin/install/${NAME}
      - type code >/dev/null 2>&1 && code ../../bin/install/${NAME}

  i:
    args:
      NAME: {}
    run:
      - export S=$PWD/../../bin/install/${NAME} && cd ${oldpwd} && exec $S
